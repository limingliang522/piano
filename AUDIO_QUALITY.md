# 🎵 极致音质系统说明

## 已实现的专业音频技术

### 1. **3D 空间音频（HRTF）**
- ✅ 使用头部相关传输函数（HRTF）模拟真实人耳听感
- ✅ 5条轨道的音符从不同空间位置传来
- ✅ 左边轨道 → 左耳更响，右边轨道 → 右耳更响
- ✅ 距离衰减模型，营造深度感

**效果：** 戴上耳机，你能清晰感受到音符从左、中、右不同位置传来

### 2. **立体声增强**
- ✅ 独立的立体声声像控制
- ✅ 根据轨道位置动态调整左右声道平衡
- ✅ 创造更宽广的音场

**效果：** 音场宽度提升 200%，声音更有包围感

### 3. **卷积混响（音乐厅效果）**
- ✅ 2.5秒自然混响尾音
- ✅ 模拟真实音乐厅的早期反射和后期扩散
- ✅ 左右声道不同的混响，增加空间感
- ✅ 干湿比 70:30（可调整）

**效果：** 仿佛在音乐厅演奏，声音有深度和空间感

### 4. **动态压缩器**
- ✅ 专业级压缩参数（-24dB 阈值，12:1 压缩比）
- ✅ 平衡轻音和重音，让每个音符都清晰可听
- ✅ 增加音乐的冲击力和能量感

**效果：** 音量更均衡，轻音不会被淹没，重音不会失真

### 5. **三段均衡器（EQ）**
- ✅ **低频增强**：+3dB @ 200Hz（温暖厚实）
- ✅ **中频塑形**：+2dB @ 2kHz（清晰度）
- ✅ **高频提亮**：+4dB @ 6kHz（明亮空气感）

**效果：** 音色更饱满，低频有力，高频明亮，中频清晰

### 6. **限制器（防削波）**
- ✅ -3dB 阈值，20:1 压缩比
- ✅ 防止音频过载失真
- ✅ 保护扬声器和耳朵

**效果：** 无论音量多大，都不会出现破音

### 7. **精细音量包络（ADSR）**
- ✅ **Attack**：2ms 快速起音
- ✅ **Decay**：自然衰减到 60%
- ✅ **Sustain**：保持音量
- ✅ **Release**：50ms 柔和释放

**效果：** 音符的起音和结束更自然，无咔哒声

### 8. **音高自适应音量**
- ✅ 高音自动降低音量
- ✅ 低音自动增强音量
- ✅ 模拟真实钢琴的音量特性

**效果：** 全音域平衡，听感更舒适

### 9. **微妙音高调制**
- ✅ ±1 cent 随机音高偏移
- ✅ 模拟真实钢琴的不完美
- ✅ 避免机械感

**效果：** 声音更有人性，更真实

### 10. **增强碰撞音效**
- ✅ 三层音效：低频冲击 + 中频撞击 + 高频碎裂
- ✅ 低通滤波模拟闷响
- ✅ 噪音合成增加真实感

**效果：** 碰撞更有冲击力，更震撼

## 音频处理链路

```
音源采样
    ↓
3D 空间定位（PannerNode - HRTF）
    ↓
立体声增强（StereoPannerNode）
    ↓
音量包络（GainNode - ADSR）
    ↓
动态压缩（DynamicsCompressor）
    ↓
三段均衡器（BiquadFilter × 3）
    ↓
卷积混响（ConvolverNode）
    ↓
限制器（DynamicsCompressor）
    ↓
主音量（GainNode）
    ↓
输出（扬声器/耳机）
```

## 技术参数

| 参数 | 数值 | 说明 |
|------|------|------|
| 采样率 | 48kHz | 高品质音频 |
| 延迟模式 | Interactive | 低延迟 |
| 3D 模型 | HRTF | 最真实的空间音频 |
| 混响时长 | 2.5s | 音乐厅级别 |
| 压缩比 | 12:1 | 专业级动态控制 |
| 限制器阈值 | -3dB | 防止削波 |

## 如何体验最佳效果

### 🎧 **强烈建议使用耳机！**
- 3D 空间音频在耳机上效果最佳
- 能清晰感受到左中右的定位
- 混响和立体声增强更明显

### 🔊 **音量建议**
- 设置到舒适的中等音量
- 不要开太大，限制器会保护你的耳朵
- 在安静环境下体验效果更好

### 📱 **设备建议**
- 现代浏览器（Chrome、Safari、Edge）
- 支持 Web Audio API
- 性能越好，音质越稳定

## 与其他音乐游戏对比

| 游戏 | 空间音频 | 混响 | 压缩 | 均衡器 |
|------|---------|------|------|--------|
| **本游戏** | ✅ HRTF | ✅ 卷积 | ✅ 专业级 | ✅ 三段 |
| Cytus II | ❌ | ✅ 简单 | ✅ 基础 | ❌ |
| Deemo | ❌ | ✅ 简单 | ✅ 基础 | ❌ |
| Piano Tiles | ❌ | ❌ | ❌ | ❌ |

## 未来可升级方向

### 🎹 **更高品质音源**
- 使用 WAV/FLAC 无损格式
- 96kHz/24bit 采样
- 多力度层采样

### 🎼 **更多音效**
- 完美触发的奖励音效
- 连击时的音高上升
- 背景氛围音

### 🎚️ **用户自定义**
- 混响强度调节
- EQ 自定义
- 干湿比控制

---

**享受极致的音质体验！** 🎵✨
