# 音频系统完全简化说明

## 已删除的所有音色系统

### 删除的组件

1. **施坦威 D 型音色模拟系统**（已完全删除）
   - 低频增强滤波器 (steinwayLow)
   - 中低频共鸣滤波器 (steinwayBody)
   - 中频清晰度滤波器 (steinwayClarity)
   - 高频明亮度滤波器 (steinwayBrilliance)
   - 音乐厅混响干湿比控制 (steinwayReverbDry/Wet)

2. **多段压缩器系统**（已完全删除）
   - 三频段分频器 (低频/中频/高频)
   - 各频段独立压缩器
   - Makeup Gain 控制

3. **专业音频处理链**（已完全删除）
   - 卷积混响 (convolver)
   - 三段均衡器 (eqLow/eqMid/eqHigh)
   - 砖墙限制器 (limiter)
   - 平滑限幅器 (hardClipper)

4. **钢琴采样系统**（已完全删除）
   - 12个基础音符采样文件
   - 采样加载逻辑
   - 采样缓存 (samples Map)
   - 音符名称转换
   - 采样查找和音高调整

5. **相关文件**（已删除）
   - `test-steinway.html` - 音色测试页面
   - `download-iowa-steinway.ps1` - 采样下载脚本
   - `download-steinway-real.ps1` - 采样下载脚本
   - `get-bright-piano.ps1` - 采样下载脚本
   - `钢琴/` 文件夹中的所有 MP3 采样文件

### 新的实现方式

**使用 Web Audio API 合成音**
- 使用 OscillatorNode 生成正弦波
- MIDI 音符直接转换为频率
- 无需加载任何外部音频文件
- 即时初始化，无加载延迟

### 保留的功能

1. **基础音频播放**
   - MIDI 音符转频率
   - 合成音生成
   - 音符播放和停止

2. **空间音频**
   - 3D 空间定位 (panner)
   - 立体声声像 (stereoPanner)
   - 性能模式切换

3. **音量控制**
   - 主音量控制 (masterGain)
   - ADSR 包络
   - Velocity 映射

### 简化后的音频链路

```
振荡器 → [3D定位/立体声] → 音量包络 → 主音量 → 输出
```

### 代码变化

- `audio-engine.js`: 从 930 行简化到约 300 行
- 删除了所有音色模拟相关的滤波器和效果器
- 删除了所有采样加载和管理代码
- 改用合成音，无需外部文件

### 性能提升

- 无需加载任何音频文件
- 启动速度极快（无加载延迟）
- 大幅减少内存使用
- 降低了 CPU 使用率
- 简化了音频处理链路

### 文件大小变化

- 删除了约 50MB 的采样文件
- 代码减少了约 60%
- 总体项目大小大幅减小
