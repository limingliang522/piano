<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steinway Grand Piano éŸ³è‰²æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        h1 {
            text-align: center;
            color: #4CAF50;
        }
        .status {
            padding: 20px;
            background: #2a2a2a;
            border-radius: 8px;
            margin: 20px 0;
        }
        .progress {
            width: 100%;
            height: 30px;
            background: #333;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        button {
            padding: 15px 30px;
            font-size: 16px;
            margin: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
            transition: background 0.3s;
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        .controls {
            text-align: center;
            margin: 30px 0;
        }
        .info {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ¹ Steinway Grand Piano éŸ³è‰²æµ‹è¯•</h1>
    
    <div class="status">
        <h3>åŠ è½½çŠ¶æ€</h3>
        <div class="progress">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>
        <p id="statusText">å‡†å¤‡åŠ è½½...</p>
    </div>
    
    <div class="controls">
        <button id="initBtn">åˆå§‹åŒ–éŸ³é¢‘å¼•æ“</button>
        <button id="testBtn" disabled>æµ‹è¯•éŸ³é˜¶</button>
        <button id="chordBtn" disabled>æµ‹è¯•å’Œå¼¦</button>
    </div>
    
    <div class="info">
        <h3>éŸ³è‰²ä¿¡æ¯</h3>
        <p>ğŸ¼ éŸ³è‰²ï¼šSteinway Grand Piano</p>
        <p>ğŸ“Š é‡‡æ ·ç‚¹ï¼š12ä¸ªéŸ³ç¬¦</p>
        <p>ğŸšï¸ åŠ›åº¦å±‚ï¼š4å±‚ï¼ˆDyn1-4ï¼‰</p>
        <p>ğŸ”„ è½®è¯¢ï¼š2ä¸ªï¼ˆRR1-2ï¼‰</p>
        <p>ğŸ“¦ æ€»é‡‡æ ·æ•°ï¼š96ä¸ª MP3 æ–‡ä»¶</p>
        <p>âœ¨ ç‰¹ç‚¹ï¼šä¸“ä¸šçº§å¤šå±‚é‡‡æ ·ï¼ŒçœŸå®åŠ¨æ€è¡¨ç°</p>
    </div>
    
    <script src="audio-engine.js"></script>
    <script>
        const audioEngine = new AudioEngine();
        const progressBar = document.getElementById('progressBar');
        const statusText = document.getElementById('statusText');
        const initBtn = document.getElementById('initBtn');
        const testBtn = document.getElementById('testBtn');
        const chordBtn = document.getElementById('chordBtn');
        
        initBtn.addEventListener('click', async () => {
            initBtn.disabled = true;
            statusText.textContent = 'æ­£åœ¨åŠ è½½ Steinway Grand Piano éŸ³è‰²...';
            
            try {
                await audioEngine.init((loaded, total) => {
                    const percent = Math.round((loaded / total) * 100);
                    progressBar.style.width = percent + '%';
                    progressBar.textContent = percent + '%';
                    statusText.textContent = `åŠ è½½ä¸­... ${loaded}/${total} é‡‡æ ·`;
                });
                
                await audioEngine.start();
                
                statusText.textContent = 'âœ… Steinway Grand Piano éŸ³è‰²åŠ è½½å®Œæˆï¼';
                testBtn.disabled = false;
                chordBtn.disabled = false;
                
                console.log('éŸ³é¢‘å¼•æ“çŠ¶æ€:', audioEngine.getStatus());
            } catch (error) {
                statusText.textContent = 'âŒ åŠ è½½å¤±è´¥: ' + error.message;
                console.error('åŠ è½½é”™è¯¯:', error);
                initBtn.disabled = false;
            }
        });
        
        testBtn.addEventListener('click', () => {
            statusText.textContent = 'ğŸµ æ’­æ”¾éŸ³é˜¶...';
            
            // æ’­æ”¾ C å¤§è°ƒéŸ³é˜¶ï¼ˆC4-C5ï¼‰
            const scale = [60, 62, 64, 65, 67, 69, 71, 72]; // C D E F G A B C
            let delay = 0;
            
            scale.forEach((note, index) => {
                setTimeout(() => {
                    audioEngine.playNote(note, 0.8, 80 + index * 5, 2);
                }, delay);
                delay += 400;
            });
            
            setTimeout(() => {
                statusText.textContent = 'âœ… éŸ³é˜¶æ’­æ”¾å®Œæˆ';
            }, delay);
        });
        
        chordBtn.addEventListener('click', () => {
            statusText.textContent = 'ğŸµ æ’­æ”¾å’Œå¼¦...';
            
            // æ’­æ”¾ C å¤§ä¸‰å’Œå¼¦ï¼ˆC4 E4 G4ï¼‰
            audioEngine.playNote(60, 2.0, 90, 2); // C4
            audioEngine.playNote(64, 2.0, 85, 2); // E4
            audioEngine.playNote(67, 2.0, 80, 2); // G4
            
            setTimeout(() => {
                statusText.textContent = 'âœ… å’Œå¼¦æ’­æ”¾å®Œæˆ';
            }, 2500);
        });
    </script>
</body>
</html>
